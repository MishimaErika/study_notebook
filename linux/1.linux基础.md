
## 1. 基本概念

### 1. 操作系统核心-内核

----

1. **内核职责**
    - 进程调度： 计算机内均配备1个或多个cpu，以执行程序指令。Linux属于属于抢占式多任务操作系统，"多任务"指多个进程可同时驻留与内存，且每个进程都能获得对cpu的使用权。 "抢占"则指一组规则。这组规则控制着哪些进程可以获得对cpu的使用，以及能够使用多长时间，这两者都由内核进程调度程序决定。 
    - 内存管理： 内核必须以公平，高效的方式在进程间共享内存这一资源。
      - linux采用虚拟内存机制，主要有以下优势： 
          1. 进程与进程、进程与内核之间彼此隔离。
          2. 只需将程序一部分保持在内存，不但降低每个进程对内存需求量，而且在RAM中同时加载更多的进程。提高了cpu的利用率。
    - 文件系统管理： 内核在磁盘之上提供文件系统，允许对文件执行创建、获取、更新、删除操作。
    - 进程管理： 内核可将新程序装入内存，为其提供运行时需要的资源，这样一个运行中的程序称之为"进程", 一旦进程执行完毕，内核还要回收相关资源。
    - 设备管理：计算机外接设备（鼠标、键盘、磁盘等）可实现计算机与外部世界通信，内核即为程序访问设备提供了简化版的标准接口，同时还要仲裁多个进程对每个设备的访问。
    - 联网： 内核以用户进程名义收发网络数据包
    - 提供系统调用接口api： 进程可利用系统调用请求内核去执行各种任务。

2. **内核态和用户态**
   
    1. 内核态(Kernel Space)
       - 具有最高特权级别，是操作系统核心运行环境。
       - 操作系统可直接访问系统资源和硬件，并执行特权指令。
       - 内核态代码运行在特殊内存管理区域中，称为 "内核空间"。
       - 内核态的代码通常负责管理系统资源、调度进程、处理中断等核心功能。
    2. 用户态(User Space)
       - 用户态是用户程序的执行环境，具有较低的特权级别。
       - 在用户态中，用户程序只能访问被允许的系统资源，并不能直接访问硬件设备或执行特权指令。
       - 用户态的程序运行在受限制的内存区域中，通常称为用户空间（User Space），这个区域可以被操作系统管理和保护。
       - 大多数应用程序和用户进程都在用户态下执行。

---
3. **SHELL**
   
   >shell 主要读取用户输入的命令，并执行相应的程序。有时，也叫命令解释器。

---
4. **相关常量**
   
   > 由<linux/limits.h>定义,
   ```c
    #define NAME_MAX         255  // 文件名长度
    #define PATH_MAX        4096  // 文件路径的长度
   ```

---
5. **用户和组**
   
    1. 系统的每个用户都有一个唯一的登录名和uid `/etc/passwd` 文件, 超级用户`uid一般为0 名称一般为 root`访问文件不经过权限检查
    2. 出于对用户的管理，可将每个用户隶属于多个组。
---
6. **文件IO模型**
   
   1.  文件描述符: 代指一个打开的文件。

7.  **进程内存布局**
    1. 文本段(text): 程序运行的指令
    2. 数据段(data): 已经显式初始化的全局变量，静态变量
    3. 未初始化数据段(bss): 未经显式初始化的全局变量，静态变量
    4. 堆(heap): 用户手动分配的内存(malloc)
    5. 栈(stack): 随函数调用、返回而增减的一片内存。

        ```
        // 可通过size命令查看
        erika@DESKTOP-H097AKH:~/linux_c_study$ size a.out
        text    data     bss     dec     hex filename
        4496     736      16    5248    1480 a.out
        ```